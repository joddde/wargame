<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <!-- helps on mobile -->
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Text-Based Game</title>

  <!-- ===== Kill any native prompts/alerts/confirms (put FIRST) ===== -->
  <script>
    (function () {
      try {
        const block = (name, ret) => function (...args) {
          console.warn(`[blocked ${name}]`, ...args);
          return ret;
        };
        window.alert = block('alert', undefined);
        window.confirm = block('confirm', false);
        window.prompt = block('prompt', null);
      } catch (e) { /* no-op */ }
    })();
  </script>
  <!-- =============================================================== -->

  <style>
    :root {
      --bg: #000;
      --fg: #00d000; /* terminal green */
      --fg-dim: #0a8f0a;
      --accent: #1aff1a;
    }

    * { box-sizing: border-box; }
    html, body {
      height: 100%;
      margin: 0;
      background: var(--bg);
      color: var(--fg);
      font-family: "Courier New", Courier, monospace;
    }

    body { display: flex; flex-direction: column; }
    #game {
      padding: 16px 16px 96px; /* bottom space for sticky controls */
      white-space: pre-wrap;   /* preserve line breaks but allow wrap */
      line-height: 1.4;
      overflow-y: auto;
      flex: 1 1 auto;
      -webkit-overflow-scrolling: touch;
    }

    /* For inline/wrapping rows (cities, countdown numbers) */
    .inline-row {
      white-space: normal;     /* allow wrapping across width */
      word-break: break-word;  /* wrap long chunks if needed */
    }

    /* Sticky on-screen controls (no popups) */
    #controls {
      position: sticky;
      bottom: 0; left: 0; right: 0;
      background: linear-gradient(180deg, rgba(0,0,0,0), rgba(0,0,0,0.85) 30%, rgba(0,0,0,1) 100%);
      padding: 12px 16px 16px;
      display: none; /* shown when needed */
      border-top: 1px solid #033603;
    }
    #question {
      margin: 0 0 8px 0;
      color: var(--accent);
      font-weight: bold;
      font-size: clamp(14px, 2.6vw, 18px);
    }
    .row {
      display: flex;
      gap: 8px;
      align-items: center;
      flex-wrap: wrap;
    }
    input[type="number"] {
      background: #001900;
      color: var(--fg);
      border: 1px solid #065e06;
      padding: 10px 12px;
      border-radius: 6px;
      font-size: clamp(14px, 3vw, 18px);
      width: 140px;
      -moz-appearance: textfield;
    }
    input[type="number"]::-webkit-outer-spin-button,
    input[type="number"]::-webkit-inner-spin-button {
      -webkit-appearance: none;
      margin: 0;
    }
    button {
      background: #002e00;
      color: var(--fg);
      border: 1px solid #0a8f0a;
      padding: 12px 16px;
      border-radius: 6px;
      font-size: clamp(14px, 3.2vw, 18px);
      min-height: 44px; /* touch target */
      cursor: pointer;
    }
    button:hover { background: #003a00; }
    button:active { background: #004400; }
    button.primary { background: #014a01; border-color: #11a511; }
    .dim { color: var(--fg-dim); }

    @media (prefers-reduced-motion: reduce) {
      * { scroll-behavior: auto !important; }
    }
  </style>
</head>
<body>
  <div id="game" aria-live="polite" aria-label="Game terminal output"></div>

  <!-- Inline, on-screen launch choice -->
  <div id="controls" role="group" aria-label="Launch decision controls">
    <p id="question"></p>
    <div class="row">
      <input
        id="missileCount"
        type="number"
        inputmode="numeric"
        pattern="[0-9]*"
        min="1"
        step="1"
        placeholder="How many?"
        aria-label="Number of missiles to launch"
      />
      <button id="btnLaunch" class="primary" type="button">Launch</button>
      <button id="btnNoLaunch" type="button">Do Not Launch</button>
    </div>
  </div>

  <script>
    // Elements
    const gameEl = document.getElementById('game');
    const controlsEl = document.getElementById('controls');
    const questionEl = document.getElementById('question');
    const missileInput = document.getElementById('missileCount');
    const btnLaunch = document.getElementById('btnLaunch');
    const btnNoLaunch = document.getElementById('btnNoLaunch');

    // State
    let missilesChosen = 0; // user's launch count

    // Utils
    function displayMessage(message = '') {
      gameEl.innerText += (message + '\n');
      gameEl.scrollTop = gameEl.scrollHeight;
    }
    function clearScreen() { gameEl.innerText = ''; }
    function sleep(ms) { return new Promise(res => setTimeout(res, ms)); }

    // Inline question controls
    function showLaunchQuestion() {
      questionEl.textContent = 'Do you want to launch nuclear missiles at China? If yes, how many?';
      missileInput.value = '';
      controlsEl.style.display = 'block';
      missileInput.focus({ preventScroll: false });
