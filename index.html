<!-- BLOCK all native modals + log where they were called -->
<script>
  (function () {
    // Block alert/confirm/prompt and show call site
    function blockModal(name, fallbackReturn) {
      const original = window[name];
      const stub = function (...args) {
        try {
          console.warn(`[BLOCKED ${name}]`, ...args);
          // Show a stack trace so we can see which file/line tried to call it
          console.trace(`[STACK for ${name}]`);
        } catch (e) {}
        return fallbackReturn;
      };
      try {
        Object.defineProperty(window, name, { configurable: true, writable: true, value: stub });
      } catch {
        window[name] = stub;
      }
    }
    blockModal('alert', undefined);
    blockModal('confirm', false);
    blockModal('prompt', null);

    // Prevent "Leave site?" / navigation confirmation dialogs
    try {
      // 1) Block direct property assignment
      Object.defineProperty(window, 'onbeforeunload', {
        configurable: true,
        get() { return null; },
        set(fn) {
          console.warn('[BLOCKED onbeforeunload assignment]', fn);
          // no-op
        }
      });
    } catch {}

    // 2) Block addEventListener('beforeunload', ...)
    (function () {
      const origAdd = window.addEventListener;
      window.addEventListener = function (type, listener, options) {
        if (String(type).toLowerCase() === 'beforeunload') {
          console.warn('[BLOCKED beforeunload listener]', listener);
          return;
        }
        return origAdd.call(this, type, listener, options);
      };
    })();

    // Optional: block window.open pop-up windows (just in case)
    try {
      const origOpen = window.open;
      window.open = function (...args) {
        console.warn('[BLOCKED window.open]', args);
        return null;
      };
    } catch {}
  })();
</script>
